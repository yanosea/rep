<!-- pege of config/daily for config report/daily_conf.toml and dest/daily_dest_conf.toml -->
@page "/config/daily"

<div class="m-auto max-w-screen-md px-6 md:px-4 lg:px-0 py-8 space-y-8">
    <Title title="config" />
    <ConfigTab config="daily" />
    <h2 class="mb-1 font-bold text-xl">preferences</h2>
    <TimeBox icon="clock"
             placeholder="00:00"
             text="threshold time"
             step="Libs.DataHolder.Instance.GetDailyConfig().Preferences.IntervalMinutes * 60"
    @bind-value="thresholdTime" />
    <NumberBox icon="presentation-chart-line"
               placeholder="30"
               text="interval minutes"
               min="0"
               max="60"
    @bind-value="intervalMinutes" />
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="time format"
    @bind-value="timeFormat" />
    <h2 class="mb-1 font-bold text-xl">templates</h2>
    <h3 class="mb-1 font-bold text-lg">opening</h3>
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="opening subject template"
    @bind-value="openingSubjectTemplate" />
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="opening head template"
    @bind-value="openingHeadTemplate" />
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="opening foot template"
    @bind-value="openingFootTemplate" />
    <h3 class="mb-1 font-bold text-lg">closing</h3>
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="closing subject template"
    @bind-value="closingSubjectTemplate" />
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="closing head template"
    @bind-value="closingHeadTemplate" />
    <TextArea icon="puzzle-piece"
              placeholder="example"
              text="closing foot template"
    @bind-value="closingFootTemplate" />
    <h2 class="mb-1 font-bold text-xl">destination</h2>
    <details open>
        <summary>
            <h3 class="inline-flex mb-1 font-bold text-lg">tos</h3>
        </summary>
        @if (tos.Count() == 0)
        {
            <p class="w-full px-6">none</p>
        }
        else
        {
            @foreach (var to in tos)
            {
                <div @key="to.Id">
                    <span class="inline-flex w-full items-center">
                        <h4 class="mb-1 font-bold text-base px-6">to</h4>
                        <div @onclick="() => RemoveFromTos(to)" class="flex justify-end ml-auto">
                            <Button icon="minus-circle"
                                    text="remove"
                                    bg="bg-red-500"
                                    bg_hover="bg-red-700"
                                    font_color="text-white" />
                        </div>
                    </span>
                    <TextBox icon="user"
                             placeholder="example"
                             text="name"
                    @bind-value="to.Name" />
                    <TextBox icon="at-symbol"
                             placeholder="example@example.com"
                             text="mailaddress"
                    @bind-value="to.Mailaddress" />
                </div>
            }
        }
        <div @onclick="AddTo">
            <Button icon="plus-circle"
                    text="add"
                    bg="bg-green-500"
                    bg_hover="bg-green-700"
                    font_color="text-white" />
        </div>
    </details>
    <details open>
        <summary>
            <h3 class="inline-flex mb-1 font-bold text-lg">ccs</h3>
        </summary>
        @if (ccs.Count() == 0)
        {
            <p class="w-full px-6">none</p>
        }
        else
        {
            @foreach (var cc in ccs)
            {
                <div @key="cc.Id">
                    <span class="inline-flex w-full items-center">
                        <h4 class="mb-1 font-bold text-base px-6">cc</h4>
                        <div @onclick="() => RemoveFromCcs(cc)" class="flex justify-end ml-auto">
                            <Button icon="minus-circle"
                                    text="remove"
                                    bg="bg-red-500"
                                    bg_hover="bg-red-700"
                                    font_color="text-white" />
                        </div>
                    </span>
                    <TextBox icon="user"
                             placeholder="example"
                             text="name"
                    @bind-value="cc.Name" />
                    <TextBox icon="at-symbol"
                             placeholder="example@example.com"
                             text="mailaddress"
                    @bind-value="cc.Mailaddress" />
                </div>
            }
        }
        <div @onclick="AddCc">
            <Button icon="plus-circle"
                    text="add"
                    bg="bg-green-500"
                    bg_hover="bg-green-700"
                    font_color="text-white" />
        </div>
    </details>
    <details open>
        <summary>
            <h3 class="inline-flex mb-1 font-bold text-lg">bccs</h3>
        </summary>
        @if (bccs.Count() == 0)
        {
            <p class="w-full px-6">none</p>
        }
        else
        {
            @foreach (var bcc in bccs)
            {
                <div @key="bcc.Id">
                    <span class="inline-flex w-full items-center">
                        <h4 class="mb-1 font-bold text-base px-6">bcc</h4>
                        <div @onclick="() => RemoveFromBccs(bcc)" class="flex justify-end ml-auto">
                            <Button icon="minus-circle"
                                    text="remove"
                                    bg="bg-red-500"
                                    bg_hover="bg-red-700"
                                    font_color="text-white" />
                        </div>
                    </span>
                    <TextBox icon="user"
                             placeholder="example"
                             text="name"
                    @bind-value="bcc.Name" />
                    <TextBox icon="at-symbol"
                             placeholder="example@example.com"
                             text="mailaddress"
                    @bind-value="bcc.Mailaddress" />
                </div>
            }
        }
        <div @onclick="AddBcc">
            <Button icon="plus-circle"
                    text="add"
                    bg="bg-green-500"
                    bg_hover="bg-green-700"
                    font_color="text-white" />
        </div>
    </details>
    <Button icon="bookmark-square"
            text="save"
            bg="bg-blue-500"
            bg_hover="bg-blue-700"
            font_color="text-white"
            OnClick="SaveDaily" />
</div>
